import{C as n,s as t,D as s,E as e,F as r}from"./index-1edbf96d.js";const o=[];function c(s,e=n){let r;const c=[];function u(n){if(t(s,n)&&(s=n,r)){const n=!o.length;for(let t=0;t<c.length;t+=1){const n=c[t];n[1](),o.push(n,s)}if(n){for(let n=0;n<o.length;n+=2)o[n][0](o[n+1]);o.length=0}}}return{set:u,update:function(n){u(n(s))},subscribe:function(t,o=n){const i=[t,o];return c.push(i),1===c.length&&(r=e(u)||n),t(s),()=>{const n=c.indexOf(i);-1!==n&&c.splice(n,1),0===c.length&&(r(),r=null)}}}}function u(t,o,u){const i=!Array.isArray(t),l=i?[t]:t,f=o.length<2;return{subscribe:c(u,(t=>{let c=!1;const u=[];let a=0,h=n;const b=()=>{if(a)return;h();const s=o(i?u[0]:u,t);f?t(s):h=r(s)?s:n},g=l.map(((n,t)=>s(n,(n=>{u[t]=n,a&=~(1<<t),c&&b()}),(()=>{a|=1<<t}))));return c=!0,b(),function(){e(g),h()}})).subscribe}}export{u as d,c as w};
